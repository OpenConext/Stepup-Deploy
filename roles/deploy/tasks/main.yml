
- name: Get active component
  shell: readlink /opt/www/{{ gateway_vhost_name }}
  ignore_errors: true
  register: active_component

- debug:
    msg: "Currently installed component: {{ active_component.stdout }}; Component to be installed: {{ component_dir_name }}; Asset version: {{ stable_nonce }}"



- block:
  - name: Create stepup directory
    file: path={{ component_dir_name }} state=directory group={{ component_group }} mode=755

  - name: Untar component
    unarchive: copy=yes src={{ component_tarball_name }} dest={{ component_dir_name }} group={{ component_group }}
    when: ({{ component_unarchive | default(1) }} == 1)

  - name: Remove group and world write
    file: dest={{ component_dir_name }} group={{ component_group }} recurse=yes mode="g-w,o-w"
  when: not {{ develop | default(false) }}

